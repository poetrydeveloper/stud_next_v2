 –†–æ—É—Ç: /api/product-units/[id]/sprout
üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ (—Ä–∞–∑–≤–µ—Ç–≤–ª–µ–Ω–∏–µ). –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–¥–∏–Ω CANDIDATE –≤ SPROUTED —Ä–æ–¥–∏—Ç–µ–ª—è –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ IN_REQUEST –¥–æ—á–µ—Ä–Ω–∏—Ö —é–Ω–∏—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏/–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞–º–∏.

üîß –ú–µ—Ç–æ–¥
POST /api/product-units/[id]/sprout
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –∏–∑ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞

üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
Path –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
id (number) - ID —Ç–æ–≤–∞—Ä–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã-–∫–∞–Ω–¥–∏–¥–∞—Ç–∞

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
json
{
  "requests": [
    {
      "quantity": number,      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (>= 1)
      "pricePerUnit": number   // —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (> 0)
    }
  ]
}
üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
1. –í–∞–ª–∏–¥–∞—Ü–∏—è:
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ requests - –º–∞—Å—Å–∏–≤ —Å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –∫–∞–∂–¥—ã–π request –∏–º–µ–µ—Ç quantity >= 1

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –∫–∞–∂–¥—ã–π request –∏–º–µ–µ—Ç pricePerUnit > 0

2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è:
–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:

A. –°–æ–∑–¥–∞–Ω–∏–µ CLEAR –∑–∞–º–µ–Ω—ã:

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π CLEAR —é–Ω–∏—Ç –∫–∞–∫ –∑–∞–º–µ–Ω—É –æ—Ä–∏–≥–∏–Ω–∞–ª—É

–ö–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—è

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä

B. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è:

–ü–µ—Ä–µ–≤–æ–¥–∏—Ç —Ä–æ–¥–∏—Ç–µ–ª—è –≤ —Å—Ç–∞—Ç—É—Å SPROUTED

–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–ø—Ä–æ—Å–∞—Ö

C. –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏—Ö —é–Ω–∏—Ç–æ–≤:

–î–ª—è –∫–∞–∂–¥–æ–≥–æ quantity —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π IN_REQUEST —é–Ω–∏—Ç

–ö–∞–∂–¥—ã–π —é–Ω–∏—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ—é —Ü–µ–Ω—É requestPricePerUnit

–°–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞: {parent_serial}/child-{sequence}

–ö–∞–∂–¥—ã–π —é–Ω–∏—Ç = 1 —à—Ç—É–∫–∞ (quantityInRequest: 1)

D. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

–õ–æ–≥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –¥–æ—á–µ—Ä–Ω–µ–≥–æ —é–Ω–∏—Ç–∞

–§–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–∏ sprout —É —Ä–æ–¥–∏—Ç–µ–ª—è

üìä –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
json
{
  "ok": true,
  "data": {
    "parent": { /* SPROUTED —Ä–æ–¥–∏—Ç–µ–ª—å */ },
    "children": [ /* –º–∞—Å—Å–∏–≤ IN_REQUEST –¥–æ—á–µ—Ä–Ω–∏—Ö —é–Ω–∏—Ç–æ–≤ */ ],
    "clearReplacementUnit": { /* CLEAR —é–Ω–∏—Ç-–∑–∞–º–µ–Ω–∞ */ },
    "childrenCount": number,
    "totalQuantity": number,
    "requests": [ /* –∏—Å—Ö–æ–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã */ ]
  },
  "message": "–¢–µ–∫—Å—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"
}
‚ùå –û—à–∏–±–∫–∏:
json
// 400 - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
{
  "ok": false,
  "error": "requests array required with at least one item"
}

// 400 - –ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ —Ü–µ–Ω–∞
{
  "ok": false,
  "error": "Each request must have quantity >= 1"
}

// 404 - –†–æ–¥–∏—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
{
  "ok": false,
  "error": "Parent unit not found"
}

// 400 - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Ä–æ–¥–∏—Ç–µ–ª—è
{
  "ok": false,
  "error": "Parent unit must be in CANDIDATE status"
}
üéØ –°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
1. CLEAR Replacement Unit:
–°—Ç–∞—Ç—É—Å: CLEAR

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ó–∞–º–µ–Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ

–î–∞–Ω–Ω—ã–µ: –ö–æ–ø–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è —Å –Ω–æ–≤—ã–º —Å–µ—Ä–∏–π–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º

2. SPROUTED Parent:
–°—Ç–∞—Ç—É—Å: SPROUTED

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –†–æ–¥–∏—Ç–µ–ª—å –¥–ª—è –¥–æ—á–µ—Ä–Ω–∏—Ö –∑–∞—è–≤–æ–∫

–î–∞–Ω–Ω—ã–µ: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —é–Ω–∏—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º

3. IN_REQUEST Children:
–°—Ç–∞—Ç—É—Å: IN_REQUEST

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: –ü–æ –æ–¥–Ω–æ–º—É —é–Ω–∏—Ç—É –Ω–∞ –∫–∞–∂–¥—É—é –µ–¥–∏–Ω–∏—Ü—É quantity

–¶–µ–Ω—ã: –ú–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø

–°–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞: –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è

‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ü–µ–Ω:
–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏:

json
"requests": [
  {"quantity": 2, "pricePerUnit": 1000},  // 2 —à—Ç –ø–æ 1000
  {"quantity": 3, "pricePerUnit": 900}    // 3 —à—Ç –ø–æ 900
]
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "1 —é–Ω–∏—Ç = 1 —Ç–æ–≤–∞—Ä":
–ö–∞–∂–¥—ã–π quantity —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —é–Ω–∏—Ç—ã

–£–ø—Ä–æ—â–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü

–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –ø–æ—Å—Ç–∞–≤–∫–∞–º–∏

‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
–¢–æ–ª—å–∫–æ –∏–∑ CANDIDATE: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —é–Ω–∏—Ç–∞–º–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ CANDIDATE

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞: –°–æ–∑–¥–∞–µ—Ç CLEAR —é–Ω–∏—Ç –¥–ª—è –∑–∞–º–µ–Ω—ã –Ω–∞ —Å–∫–ª–∞–¥–µ

–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –õ–æ–≥–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∫–∞–∂–¥–æ–≥–æ —é–Ω–∏—Ç–∞

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –í—Å–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ

üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
–û–¥–∏–Ω–æ—á–Ω–∞—è –∑–∞—è–≤–∫–∞: POST /api/product-units/request (quantity = 1)

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã: PATCH /api/product-units

–ü–æ—Å—Ç–∞–≤–∫–∞: PATCH /api/product-units/[id]/delivery (–¥–ª—è –¥–æ—á–µ—Ä–Ω–∏—Ö —é–Ω–∏—Ç–æ–≤)

üîÑ –°—Ç–∞—Ç—É—Å–Ω–∞—è –º–æ–¥–µ–ª—å
text
CLEAR ‚Üí CANDIDATE ‚Üí SPROUTED (—Ä–æ–¥–∏—Ç–µ–ª—å)
                    ‚Üì
              IN_REQUEST (–¥–µ—Ç–∏) + CLEAR (–∑–∞–º–µ–Ω–∞)