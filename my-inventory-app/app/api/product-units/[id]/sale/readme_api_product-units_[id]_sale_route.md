 –†–æ—É—Ç: /api/product-units/[id]/sale
üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã - –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ IN_STORE –≤ SOLD –∏–ª–∏ CREDIT —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏.

üîß –ú–µ—Ç–æ–¥
PATCH /api/product-units/[id]/sale
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–∞ (–æ–±—ã—á–Ω–∞—è –∏–ª–∏ –≤ –∫—Ä–µ–¥–∏—Ç)

üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
Path –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
id (number) - ID —Ç–æ–≤–∞—Ä–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
json
{
  "salePrice": number,        // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π (–º–æ–∂–µ—Ç –±—ã—Ç—å 0)
  "buyerName": string,        // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –∫—Ä–µ–¥–∏—Ç–∞)
  "buyerPhone": string,       // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –∫—Ä–µ–¥–∏—Ç–∞) 
  "isCredit": boolean         // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false
}
üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
1. –í–∞–ª–∏–¥–∞—Ü–∏—è:
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ salePrice

–î–ª—è –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç buyerName –∏ buyerPhone

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∫–∞—Å—Å–æ–≤–æ–≥–æ –¥–Ω—è (–¥–ª—è –Ω–µ-–∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂)

2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏:
–î–ª—è –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂:

–ò—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω

–ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∫ —é–Ω–∏—Ç—É

3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:
typescript
// –û–±—ã—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞:
statusProduct: "IN_STORE" ‚Üí "SOLD"

// –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞:  
statusProduct: "IN_STORE" ‚Üí "CREDIT"
isCredit: true
customerId: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
4. –ö–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
–û–±—ã—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏: –°–æ–∑–¥–∞–µ—Ç CashEvent —á–µ—Ä–µ–∑ CashEventService

–ö—Ä–µ–¥–∏—Ç—ã: –ù–µ —Å–æ–∑–¥–∞–µ—Ç CashEvent (–¥–µ–Ω—å–≥–∏ –Ω–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç)

–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏: –ù–µ —Å–æ–∑–¥–∞–µ—Ç CashEvent

üìä –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
json
{
  "ok": true,
  "data": { /* –ø—Ä–æ–¥–∞–Ω–Ω—ã–π ProductUnit */ }
}
‚ùå –û—à–∏–±–∫–∏:
json
// 400 - –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
{
  "ok": false,
  "error": "salePrice is required"
}

// 400 - –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫—Ä–µ–¥–∏—Ç–∞
{
  "ok": false,
  "error": "buyerName and buyerPhone required for credit"
}

// 404 - –Æ–Ω–∏—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
{
  "ok": false,
  "error": "Unit not found"  
}

// 400 - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
{
  "ok": false,
  "error": "Unit must be in IN_STORE status"
}
üí∞ –¢–∏–ø—ã –ø—Ä–æ–¥–∞–∂
1. –û–±—ã—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞:
json
{
  "salePrice": 1000,
  "isCredit": false
}
–°—Ç–∞—Ç—É—Å: SOLD

CashEvent: —Å–æ–∑–¥–∞–µ—Ç—Å—è

–ü–æ–∫—É–ø–∞—Ç–µ–ª—å: –Ω–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è

2. –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞:
json
{
  "salePrice": 1000,
  "isCredit": true,
  "buyerName": "–ò–≤–∞–Ω",
  "buyerPhone": "+79990001122"
}
–°—Ç–∞—Ç—É—Å: CREDIT

CashEvent: –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

–ü–æ–∫—É–ø–∞—Ç–µ–ª—å: —Å–æ–∑–¥–∞–µ—Ç—Å—è/–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è

3. –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞:
json
{
  "salePrice": 0,
  "isCredit": false
}
–°—Ç–∞—Ç—É—Å: SOLD

CashEvent: –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

–ü–æ–∫—É–ø–∞—Ç–µ–ª—å: –Ω–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è

üéØ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
–ö–∞—Å—Å–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å:
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –∫–∞—Å—Å–æ–≤—ã–π –¥–µ–Ω—å —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–Ω–µ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

–ö—Ä–µ–¥–∏—Ç—ã –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –¥–Ω—è

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –¥–ª—è –∫—Ä–µ–¥–∏—Ç–æ–≤

–ü–æ–∏—Å–∫ –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞

–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–¥–∞–Ω–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É

‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
–ì–∏–±–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è: –†–∞–∑–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–¥–∞–∂

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π: –î–ª—è –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂

–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á–µ—Ç: –¢–æ–ª—å–∫–æ –¥–µ–Ω–µ–∂–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ —Å–æ–∑–¥–∞—é—Ç CashEvent

üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
–í–æ–∑–≤—Ä–∞—Ç: PATCH /api/product-units/[id]/return

–û–ø–ª–∞—Ç–∞ –∫—Ä–µ–¥–∏—Ç–∞: PATCH /api/product-units/[id] —Å action: "creditPay"

–ö–∞—Å—Å–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CashEventService –∏ CashValidationService

üîÑ –°—Ç–∞—Ç—É—Å–Ω–∞—è –º–æ–¥–µ–ª—å
text
IN_STORE ‚Üí SOLD        (–æ–±—ã—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞)
        ‚Üí CREDIT       (–∫—Ä–µ–¥–∏—Ç–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞) 
        ‚Üí SOLD         (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞)